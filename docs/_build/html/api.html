

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>API &mdash; ttax 0.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Quick start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ttax
          

          
          </a>

          
            
            
              <div class="version">
                0.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-ttax.base_class">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ttax</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p>Here you can find description of functions and methods avaliable in ttax.</p>
<div class="section" id="module-ttax.base_class">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ttax.base_class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="ttax.base_class.BatchIndexing">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.base_class.</span></code><code class="sig-name descname"><span class="pre">BatchIndexing</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.base_class.BatchIndexing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="ttax.base_class.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.base_class.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.base_class.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.base_class.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.base_class.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.base_class.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.base_class.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.base_class.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.base_class.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.base_class.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.base_class.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.base_class.TTBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.base_class.</span></code><code class="sig-name descname"><span class="pre">TTBase</span></code><a class="headerlink" href="#ttax.base_class.TTBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents the base for both <cite>TT-Tensor</cite> and <cite>TT-Matrix</cite> (<cite>TT-object</cite>).
Includes some basic routines and properties.</p>
<dl class="py method">
<dt id="ttax.base_class.TTBase.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.base_class.TTBase.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTBase.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.base_class.TTBase.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTBase.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.base_class.TTBase.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTBase.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.base_class.TTBase.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTBase.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.base_class.TTBase.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTBase.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.base_class.TTBase.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.base_class.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.base_class.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.base_class.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.base_class.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.base_class.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.base_class.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.base_class.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.base_class.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.base_class.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.base_class.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.base_class.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.base_class.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<span class="target" id="module-ttax.ops"></span><dl class="py class">
<dt id="ttax.ops.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.ops.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.ops.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.ops.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.ops.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.ops.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.ops.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.ops.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.ops.TTBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">TTBase</span></code><a class="headerlink" href="#ttax.ops.TTBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents the base for both <cite>TT-Tensor</cite> and <cite>TT-Matrix</cite> (<cite>TT-object</cite>).
Includes some basic routines and properties.</p>
<dl class="py method">
<dt id="ttax.ops.TTBase.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.ops.TTBase.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTBase.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.ops.TTBase.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTBase.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.ops.TTBase.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTBase.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.ops.TTBase.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTBase.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.ops.TTBase.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTBase.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.ops.TTBase.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.ops.TTEinsum">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">TTEinsum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how_to_apply</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left-to-right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class which contains einsum rule, which is needed for fusion to work.</p>
<dl class="py method">
<dt id="ttax.ops.TTEinsum.apply_mapping">
<code class="sig-name descname"><span class="pre">apply_mapping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum.apply_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename letters according to the given mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new <cite>TTEinsum</cite> with renamed latters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>TTEinsum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTEinsum.change_input">
<code class="sig-name descname"><span class="pre">change_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum.change_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Change argument <code class="docutils literal notranslate"><span class="pre">input_idx</span></code> into <code class="docutils literal notranslate"><span class="pre">new_inputs</span></code>.</p>
<dl>
<dt>E.g.</dt><dd><p>tt_einsum = TTEinsum(inputs=[[‘a’, ‘i’, ‘b’], [‘c’, ‘i’, ‘d’]],
output=[‘ac’, ‘i’, ‘bd’],
how_to_apply=’independent’)</p>
<p>tt_einsum.change_input(0, [[‘e’, ‘i’, ‘f’], [‘g’, ‘i’, ‘h’]])</p>
<p>print(tt_einsum.to_vanilla_einsum())</p>
</dd>
</dl>
<p>will return ‘eif,gih,cid-&gt;acibd’</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTEinsum.resolve_i_or_ij">
<code class="sig-name descname"><span class="pre">resolve_i_or_ij</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_tt_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum.resolve_i_or_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a version of <cite>TTEinsum</cite> with <code class="docutils literal notranslate"><span class="pre">I_OR_IJ</span></code> changed to either ‘i’ or ‘ij’.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTEinsum.to_distinct_letters">
<code class="sig-name descname"><span class="pre">to_distinct_letters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distinct_from</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum.to_distinct_letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename letters to make them distinct from letters used in <code class="docutils literal notranslate"><span class="pre">distinct_from</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTEinsum.to_vanilla_einsum">
<code class="sig-name descname"><span class="pre">to_vanilla_einsum</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTEinsum.to_vanilla_einsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Build regular einsum.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.ops.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.ops.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.ops.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.ops.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.ops.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.ops.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.ops.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.ops.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.ops.WrappedTT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">WrappedTT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.WrappedTT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class which wraps <cite>TT-object</cite>, which is needed for fusion to work.</p>
<p>Base <cite>TT-object</cite> class can only have jnp.array objects so that you can pass it into
jitted function. But, for fusing two functions together we need to track which
operation created a <cite>TT-object</cite>, so while fusing ops we wrap <cite>TT-objects</cite> with
this class, to track that.</p>
<dl class="py method">
<dt id="ttax.ops.WrappedTT.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in underlying <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for underlying <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the underlying <cite>TT-object</cite> is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
Depends on <code class="docutils literal notranslate"><span class="pre">raw_tensor_shape</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.tt_cores">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_cores</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of <cite>TT-cores</cite> of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-cores</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.ops.WrappedTT.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.ops.WrappedTT.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the underlying <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.ops.add">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">add</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <cite>TT-object</cite> corresponding to elementwise sum <cite>tt_a + tt_b</cite>.
The shapes of <cite>tt_a</cite> and <cite>tt_b</cite> should coincide.
Supports broadcasting, e.g. you can add a tensor train with
batch size 7 and a tensor train with batch size 1:</p>
<p><code class="docutils literal notranslate"><span class="pre">tt_batch.add(tt_single.batch_loc[np.newaxis])</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">tt_single.batch_loc[np.newaxis]</span></code>
creates a singleton batch dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt_a</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – first argument</p></li>
<li><p><strong>tt_b</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – second argument</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>TT-Tensor</cite> or <cite>TT-Matrix</cite></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>tt_a + tt_b</cite></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>[</strong><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a><strong>]</strong> – if the arguments shapes do not coincide</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.are_batches_broadcastable">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">are_batches_broadcastable</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.are_batches_broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of compatibility check of 2 tensors’ batches:
<cite>True</cite> if batches are compatible and <cite>False</cite> otherwise.
The batch sizes should be equal otherwise at least one of them
should equal to 1 for broadcasting to be available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt_a</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – first argument to check</p></li>
<li><p><strong>tt_b</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – second argument to check</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the result of broadcasting check</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.are_shapes_equal">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">are_shapes_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.are_shapes_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of equality check of 2 tensors’ shapes:
<cite>True</cite> if shapes are equal and <cite>False</cite> otherwise.
The arguments should be both <cite>TT-Tensors</cite> or both <cite>TT-Matrices</cite>.
The arguments should have the same tensor shape
but their <cite>TT-ranks</cite> differ.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt_a</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – first argument to check</p></li>
<li><p><strong>tt_b</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – second argument to check</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>tensor_check</cite> - the result of shape check</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.flat_inner">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">flat_inner</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.flat_inner" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inner product of given <cite>TT-Tensors</cite> or <cite>TT-Matrices</cite> wrapped with <cite>WrappedTT</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<cite>WrappedTT</cite>) – first argument</p></li>
<li><p><strong>b</strong> (<cite>WrappedTT</cite>) – second argument</p></li>
</ul>
</dd>
<dt class="field-even">Rerurn</dt>
<dd class="field-even"><p>the result of inner product</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>WrappedTT</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.full">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">full</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><span class="pre">ttax.base_class.TTBase</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">jax._src.numpy.lax_numpy.array</span><a class="headerlink" href="#ttax.ops.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>TT-Tensor</cite> or <cite>TT-Matrix</cite> into a dense format.</p>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.full_tt_matrix">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">full_tt_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TTMatrix" title="ttax.base_class.TTMatrix"><span class="pre">ttax.base_class.TTMatrix</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">jax._src.numpy.lax_numpy.array</span><a class="headerlink" href="#ttax.ops.full_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts TT-matrix into a regular matrix.</p>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.full_tt_tensor">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">full_tt_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">jax._src.numpy.lax_numpy.array</span><a class="headerlink" href="#ttax.ops.full_tt_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts TT into a regular tensor.</p>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.is_tt_matrix">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.ops.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite> or <cite>WrappedTT</cite> with underlying <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite> or <cite>WrappedTT(TT-Matrix)</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.is_tt_object">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">is_tt_object</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.ops.is_tt_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Tensor</cite>, <cite>TT-Matrix</cite> or <cite>WrappedTT</cite> with one of them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-object</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.is_tt_tensor">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">is_tt_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.ops.is_tt_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Tensor</cite> or <cite>WrappedTT</cite> with underlying <cite>TT-Tensor</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Tensor</cite> or <cite>WrappedTT(TT-Tensor)</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.matmul">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">matmul</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.matmul" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate matrix multiplication of given <cite>TT-Matrices</cite> wrapped with <cite>WrappedTT</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<cite>WrappedTT</cite>) – first argument</p></li>
<li><p><strong>b</strong> (<cite>WrappedTT</cite>) – second argument</p></li>
</ul>
</dd>
<dt class="field-even">Rerurn</dt>
<dd class="field-even"><p>the result of inner product</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>WrappedTT</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.multiply">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">multiply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate elementwise product of 2 <cite>TT-Tensors</cite> <cite>TT-Matrices</cite> or their product by scalar. Arguments could be wrapped by <cite>WrappedTT</cite> or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>TT-object</em><em>]</em>) – first argument</p></li>
<li><p><strong>b</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>TT-object</em><em>]</em>) – second argument</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the result of elementwise product</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>TT-object</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.multiply_by_scalar">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">multiply_by_scalar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.multiply_by_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the result of multiplication so called TT-object
(TTTensOrMat or WrappedTT) by scalar. Takes 2 arguments
as input, one of which is TT-object and other is a scalar.
Does not depends on arguments order.
Returns:yj</p>
<blockquote>
<div><p>TTTensOrMat</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.to_function">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">to_function</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.compile.TTEinsum" title="ttax.compile.TTEinsum"><span class="pre">ttax.compile.TTEinsum</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#ttax.ops.to_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile TT-einsum into a function.</p>
<p>Example:</p>
<p>def multiply(a, b):</p>
<blockquote>
<div><p>tt_einsum = TTEinsum(
inputs=[[‘a’, ‘i’, ‘b’], [‘c’, ‘i’, ‘d’]],
output=[‘ac’, ‘i’, ‘bd’],
how_to_apply=’independent’
)</p>
<p>func = tt_einsum.to_function()</p>
<p>return func(a, b)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.tt_tt_multiply">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">tt_tt_multiply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.tt_tt_multiply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="ttax.ops.tt_vmap">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">tt_vmap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batch_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.tt_vmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator which makes a function support batch TT-inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_batch_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – <p>The amount of arguments that are batches of <cite>TT-objects</cite>.</p>
<ul class="simple">
<li><p>If None, than function will be mapped over all arguments.</p></li>
<li><p>If integer, specifies the count of first arguments to map over, e.g.
<cite>num_batch_args=n</cite> means that function will be mapped over
first <cite>n</cite> arguments.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decorator</p>
</dd>
</dl>
<dl class="simple">
<dt>Comments:</dt><dd><p>The function is vmapped <cite>num_batch_dims</cite> times, as it supports
multidimensional batches. The number of batch dimension to be
mapped over is shown by <cite>num_batch_dims</cite> property and should be
the same for all args of the function, by which it will be mapped over.
Otherwise such axis should be specified by <cite>num_batch_args</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.ops.unwrap_tt">
<code class="sig-prename descclassname"><span class="pre">ttax.ops.</span></code><code class="sig-name descname"><span class="pre">unwrap_tt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.ops.unwrap_tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps argument if it is of <cite>WrappedTT</cite> class,
otherwise just returns the argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>WrappedTT</cite> or <cite>TTTensOrMat</cite>) – argument to unwrap</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>TTTensOrMat</cite></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>unwrapped argument</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-ttax.decompositions"></span><dl class="py class">
<dt id="ttax.decompositions.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.decompositions.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.decompositions.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.decompositions.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.decompositions.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.decompositions.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.decompositions.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.decompositions.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.decompositions.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.decompositions.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.decompositions.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.decompositions.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.decompositions.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.decompositions.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.decompositions.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.decompositions.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.decompositions.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.decompositions.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.decompositions.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.decompositions.orthogonalize">
<code class="sig-prename descclassname"><span class="pre">ttax.decompositions.</span></code><code class="sig-name descname"><span class="pre">orthogonalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_to_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.orthogonalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Orthogonalize <cite>TT-cores</cite> of a <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – <cite>TT-object</cite> which <cite>TT-cores</cite> would be orthogonalized</p></li>
<li><p><strong>left_to_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – the direction of orthogonalization, <cite>True</cite> for left to right and <cite>False</cite> for right to left</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>TT-object</cite> with orthogonalized <cite>TT-cores</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> or <cite>TT-Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.decompositions.round">
<code class="sig-prename descclassname"><span class="pre">ttax.decompositions.</span></code><code class="sig-name descname"><span class="pre">round</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tt_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.round" title="Permalink to this definition">¶</a></dt>
<dd><p>Tensor Train rounding procedure, returns a <cite>TT-object</cite> with smaller <cite>TT-ranks</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – argument which ranks would be reduced</p></li>
<li><p><strong>max_tt_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of ints</em>) – <ul>
<li><p>If a number, than defines the maximal <cite>TT-rank</cite> of the result.</p></li>
<li><p>If a list of numbers, than <cite>max_tt_rank</cite> length should be d+1
(where d is the number of dimensions) and <cite>max_tt_rank[i]</cite>
defines the maximal (i+1)-th <cite>TT-rank</cite> of the result.</p>
<p>The following two versions are equivalent</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_tt_rank</span> <span class="pre">=</span> <span class="pre">r</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_tt_rank</span> <span class="pre">=</span> <span class="pre">[1]</span> <span class="pre">+</span> <span class="pre">[r]</span> <span class="pre">*</span> <span class="pre">(d-1)</span> <span class="pre">+</span> <span class="pre">[1]</span></code></p></li>
</ul>
</li>
</ul>
</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – <ul>
<li><p>If the <cite>TT-ranks</cite> are not restricted (<cite>max_tt_rank=None</cite>), then
the result would be guarantied to be <cite>epsilon</cite>-close to <cite>tt</cite>
in terms of relative Frobenius error:</p>
<blockquote>
<div><p><cite>||res - tt||_F / ||tt||_F &lt;= epsilon</cite></p>
</div></blockquote>
</li>
<li><p>If the <cite>TT-ranks</cite> are restricted, providing a loose <cite>epsilon</cite> may
reduce the <cite>TT-ranks</cite> of the result. E.g.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">round(tt,</span> <span class="pre">max_tt_rank=100,</span> <span class="pre">epsilon=0.9)</span></code></p>
</div></blockquote>
<p>will probably return you a <cite>TT-Tensor</cite> with <cite>TT-ranks</cite> close to 1, not 100.
Note that providing a nontrivial (= not equal to <cite>None</cite>) epsilon will make
the <cite>TT-ranks</cite> of the result change depending on the data,
which will prevent you from using <code class="docutils literal notranslate"><span class="pre">jax.jit</span></code>
for speeding up the computations.</p>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>TT-object</cite> with reduced <cite>TT-ranks</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> or <cite>TT-Matrix</cite></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p>ValueError if <cite>max_tt_rank</cite> is less than 0, if <cite>max_tt_rank</cite> is not a number and
not a vector of length d + 1 where d is the number of dimensions of
the input tensor, if <cite>epsilon</cite> is less than 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.decompositions.tt_vmap">
<code class="sig-prename descclassname"><span class="pre">ttax.decompositions.</span></code><code class="sig-name descname"><span class="pre">tt_vmap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batch_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.decompositions.tt_vmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator which makes a function support batch TT-inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_batch_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – <p>The amount of arguments that are batches of <cite>TT-objects</cite>.</p>
<ul class="simple">
<li><p>If None, than function will be mapped over all arguments.</p></li>
<li><p>If integer, specifies the count of first arguments to map over, e.g.
<cite>num_batch_args=n</cite> means that function will be mapped over
first <cite>n</cite> arguments.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decorator</p>
</dd>
</dl>
<dl class="simple">
<dt>Comments:</dt><dd><p>The function is vmapped <cite>num_batch_dims</cite> times, as it supports
multidimensional batches. The number of batch dimension to be
mapped over is shown by <cite>num_batch_dims</cite> property and should be
the same for all args of the function, by which it will be mapped over.
Otherwise such axis should be specified by <cite>num_batch_args</cite>.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-ttax.compile"></span><p>Utils for compiling functions defined as einsum strings.</p>
<p>Here we use the notion of <em>tt_einsum</em>, which is similar to einsum strings, but
with more structure.</p>
<p>Basic element of tt_einsum is a <em>tt_einsum_core</em>: list with three elements,
which defines an einsum string for a single TT-core. First element is indices
for the left TT-rank, second element is the indices for the main dimensions of
the resulting TT-core, and the last element is the indices for the right
TT-rank.</p>
<p>TT_einsum consists of list of input and output cores defined like with
tt_einsum_cores.</p>
<dl class="py class">
<dt id="ttax.compile.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.compile.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.compile.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.compile.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.compile.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.compile.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.compile.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.compile.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.compile.TTEinsum">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">TTEinsum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how_to_apply</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left-to-right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class which contains einsum rule, which is needed for fusion to work.</p>
<dl class="py method">
<dt id="ttax.compile.TTEinsum.apply_mapping">
<code class="sig-name descname"><span class="pre">apply_mapping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum.apply_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename letters according to the given mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new <cite>TTEinsum</cite> with renamed latters</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>TTEinsum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTEinsum.change_input">
<code class="sig-name descname"><span class="pre">change_input</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_idx</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum.change_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Change argument <code class="docutils literal notranslate"><span class="pre">input_idx</span></code> into <code class="docutils literal notranslate"><span class="pre">new_inputs</span></code>.</p>
<dl>
<dt>E.g.</dt><dd><p>tt_einsum = TTEinsum(inputs=[[‘a’, ‘i’, ‘b’], [‘c’, ‘i’, ‘d’]],
output=[‘ac’, ‘i’, ‘bd’],
how_to_apply=’independent’)</p>
<p>tt_einsum.change_input(0, [[‘e’, ‘i’, ‘f’], [‘g’, ‘i’, ‘h’]])</p>
<p>print(tt_einsum.to_vanilla_einsum())</p>
</dd>
</dl>
<p>will return ‘eif,gih,cid-&gt;acibd’</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTEinsum.resolve_i_or_ij">
<code class="sig-name descname"><span class="pre">resolve_i_or_ij</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_tt_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum.resolve_i_or_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a version of <cite>TTEinsum</cite> with <code class="docutils literal notranslate"><span class="pre">I_OR_IJ</span></code> changed to either ‘i’ or ‘ij’.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTEinsum.to_distinct_letters">
<code class="sig-name descname"><span class="pre">to_distinct_letters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distinct_from</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum.to_distinct_letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename letters to make them distinct from letters used in <code class="docutils literal notranslate"><span class="pre">distinct_from</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTEinsum.to_vanilla_einsum">
<code class="sig-name descname"><span class="pre">to_vanilla_einsum</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTEinsum.to_vanilla_einsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Build regular einsum.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.compile.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.compile.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.compile.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.compile.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.compile.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.compile.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.compile.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.compile.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.compile.WrappedTT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">WrappedTT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.WrappedTT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class which wraps <cite>TT-object</cite>, which is needed for fusion to work.</p>
<p>Base <cite>TT-object</cite> class can only have jnp.array objects so that you can pass it into
jitted function. But, for fusing two functions together we need to track which
operation created a <cite>TT-object</cite>, so while fusing ops we wrap <cite>TT-objects</cite> with
this class, to track that.</p>
<dl class="py method">
<dt id="ttax.compile.WrappedTT.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in underlying <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for underlying <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the underlying <cite>TT-object</cite> is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
Depends on <code class="docutils literal notranslate"><span class="pre">raw_tensor_shape</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.tt_cores">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_cores</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of <cite>TT-cores</cite> of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-cores</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.compile.WrappedTT.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.compile.WrappedTT.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the underlying <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.compile.apply_single_mapping">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">apply_single_mapping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.apply_single_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply letter mapping to a list of strings.</p>
</dd></dl>

<dl class="py function">
<dt id="ttax.compile.compile_cumulative">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">compile_cumulative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.compile.TTEinsum" title="ttax.compile.TTEinsum"><span class="pre">ttax.compile.TTEinsum</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#ttax.compile.compile_cumulative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="ttax.compile.compile_independent">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">compile_independent</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.compile.TTEinsum" title="ttax.compile.TTEinsum"><span class="pre">ttax.compile.TTEinsum</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#ttax.compile.compile_independent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="ttax.compile.fuse">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">fuse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.fuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Fuse a composite function to make it faster.</p>
<p>Example:</p>
<p>Let’s look at f(a, b, c) = &lt;a * b, c&gt; = sum_{i_1, …, i_d} a[i_1, …, i_d] b[i_1, …, i_d] c[i_1, …, i_d], as ttax.flat_inner(a * b, c) do.</p>
<p>Function <cite>f</cite> can be suboptimal for some inputs. For example, if <cite>a</cite> and <cite>b</cite>
are of large TT-rank, and <cite>c</cite> is of low TT-rank, implementing the same
operation as</p>
<blockquote>
<div><p>ttax.flat_inner(a * c, b)</p>
</div></blockquote>
<p>would be much more efficient.</p>
<p><cite>fuse</cite> automates such optimizations. You can build an optimal implementation
of this function for any inputs by doing</p>
<blockquote>
<div><p>faster_f = ttax.fuse(f)</p>
</div></blockquote>
<p>Finally, don’t forget that in JAX to get good speed you need to wrap you
highest level function in jit, e.g.</p>
<blockquote>
<div><p>faster_f = jax.jit(faster_f)</p>
</div></blockquote>
<p>Now, by using <cite>faster_f(a, b, c)</cite> instead of <cite>f(a, b, c)</cite> you can achieve
a much faster cumulative time for any inputs.</p>
</dd></dl>

<dl class="py function">
<dt id="ttax.compile.to_function">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">to_function</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.compile.TTEinsum" title="ttax.compile.TTEinsum"><span class="pre">ttax.compile.TTEinsum</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#ttax.compile.to_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile TT-einsum into a function.</p>
<p>Example:</p>
<p>def multiply(a, b):</p>
<blockquote>
<div><p>tt_einsum = TTEinsum(
inputs=[[‘a’, ‘i’, ‘b’], [‘c’, ‘i’, ‘d’]],
output=[‘ac’, ‘i’, ‘bd’],
how_to_apply=’independent’
)</p>
<p>func = tt_einsum.to_function()</p>
<p>return func(a, b)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="ttax.compile.unwrap_tt">
<code class="sig-prename descclassname"><span class="pre">ttax.compile.</span></code><code class="sig-name descname"><span class="pre">unwrap_tt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.compile.unwrap_tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps argument if it is of <cite>WrappedTT</cite> class,
otherwise just returns the argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<cite>WrappedTT</cite> or <cite>TTTensOrMat</cite>) – argument to unwrap</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>TTTensOrMat</cite></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>unwrapped argument</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-ttax.random_"></span><dl class="py class">
<dt id="ttax.random_.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.random_.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.random_.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.random_.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.random_.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.random_.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.random_.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.random_.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.random_.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.random_.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.random_.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.random_.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.random_.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.random_.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.random_.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.random_.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.random_.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.random_.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.random_.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.random_.matrix">
<code class="sig-prename descclassname"><span class="pre">ttax.random_.</span></code><code class="sig-name descname"><span class="pre">matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">rng</span></em>, <em class="sig-param"><span class="pre">shape</span></em>, <em class="sig-param"><span class="pre">tt_rank=2</span></em>, <em class="sig-param"><span class="pre">batch_shape=None</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax._src.numpy.lax_numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random <cite>TT-Matrix</cite> of the given shape and <cite>TT-rank</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>random state is described by two unsigned 32-bit integers</em>) – JAX PRNG key</p></li>
<li><p><strong>shape</strong> (<em>array</em>) – desired tensor shape</p></li>
<li><p><strong>tt_rank</strong> (single number for equal <cite>TT-ranks</cite> or array specifying all <cite>TT-ranks</cite>) – desired <cite>TT-ranks</cite> of <cite>TT-Matrix</cite></p></li>
<li><p><strong>batch_shape</strong> (<em>array</em>) – desired batch shape of <cite>TT-Matrix</cite></p></li>
<li><p><strong>dtype</strong> (<cite>dtype</cite>) – type of elements in <cite>TT-Matrix</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generated <cite>TT-Matrix</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#ttax.random_.TTMatrix" title="ttax.random_.TTMatrix">TTMatrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.random_.tensor">
<code class="sig-prename descclassname"><span class="pre">ttax.random_.</span></code><code class="sig-name descname"><span class="pre">tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">rng</span></em>, <em class="sig-param"><span class="pre">shape</span></em>, <em class="sig-param"><span class="pre">tt_rank=2</span></em>, <em class="sig-param"><span class="pre">batch_shape=None</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'jax._src.numpy.lax_numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.random_.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random <cite>TT-Tensor</cite> of the given shape and <cite>TT-rank</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>random state is described by two unsigned 32-bit integers</em>) – JAX PRNG key</p></li>
<li><p><strong>shape</strong> (<em>array</em>) – desired tensor shape</p></li>
<li><p><strong>tt_rank</strong> (single number for equal <cite>TT-ranks</cite> or array specifying all <cite>TT-ranks</cite>) – desired <cite>TT-ranks</cite> of <cite>TT-Tensor</cite></p></li>
<li><p><strong>batch_shape</strong> (<em>array</em>) – desired batch shape of <cite>TT-Tensor</cite></p></li>
<li><p><strong>dtype</strong> (<cite>dtype</cite>) – type of elements in <cite>TT-Tensor</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generated <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#ttax.random_.TT" title="ttax.random_.TT">TT</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-ttax.riemannian"></span><dl class="py class">
<dt id="ttax.riemannian.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.riemannian.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.riemannian.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.riemannian.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.riemannian.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.riemannian.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.riemannian.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.riemannian.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.riemannian.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.riemannian.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.riemannian.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.riemannian.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.riemannian.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.riemannian.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.riemannian.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.riemannian.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.riemannian.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.riemannian.deltas_to_tangent">
<code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">deltas_to_tangent</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deltas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#ttax.base_class.TTMatrix" title="ttax.base_class.TTMatrix"><span class="pre">ttax.base_class.TTMatrix</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#ttax.base_class.TTMatrix" title="ttax.base_class.TTMatrix"><span class="pre">ttax.base_class.TTMatrix</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#ttax.riemannian.deltas_to_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts deltas representation of tangent space vector to TT object.
Takes as input a list of [dP1, …, dPd] and returns</p>
<blockquote>
<div><p>dP1 V2 … Vd + U1 dP2 V3 … Vd + … + U1 … Ud-1 dPd.</p>
</div></blockquote>
<p>This function is hard to use correctly because deltas should obey the
so called gauge conditions. If they don’t, the function will silently return
incorrect result. That is why this function is not imported in __init__.
:param deltas: a list of deltas (essentially TT-cores) obeying the gauge</p>
<blockquote>
<div><p>conditions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tt</strong> – TT (or TTMatrix) object on which the tangent space tensor represented
by delta is projected.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>TT (or TTMatrix) object constructed from deltas, that is from the tangent</dt><dd><p>space at point <cite>tt</cite>.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.riemannian.orthogonalize">
<code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">orthogonalize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_to_right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.orthogonalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Orthogonalize <cite>TT-cores</cite> of a <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tt</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – <cite>TT-object</cite> which <cite>TT-cores</cite> would be orthogonalized</p></li>
<li><p><strong>left_to_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – the direction of orthogonalization, <cite>True</cite> for left to right and <cite>False</cite> for right to left</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>TT-object</cite> with orthogonalized <cite>TT-cores</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> or <cite>TT-Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.riemannian.project">
<code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">project</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Project <cite>what</cite> TTs on the tangent space of <cite>where</cite> TT.</p>
<p><code class="docutils literal notranslate"><span class="pre">project(what,</span> <span class="pre">x)</span> <span class="pre">=</span> <span class="pre">P_x(what)</span></code>
<code class="docutils literal notranslate"><span class="pre">project(batch_what,</span> <span class="pre">x)</span> <span class="pre">=</span> <span class="pre">batch(P_x(batch_what[0]),</span> <span class="pre">...,</span> <span class="pre">P_x(batch_what[N]))</span></code></p>
<dl>
<dt>Complexity:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">O(d</span> <span class="pre">r_where^3</span> <span class="pre">m)</span></code> for orthogonalizing the TT-cores of <cite>where</cite>
<code class="docutils literal notranslate"><span class="pre">+O(batch_size</span> <span class="pre">d</span> <span class="pre">r_what</span> <span class="pre">r_where</span> <span class="pre">n</span> <span class="pre">(r_what</span> <span class="pre">+</span> <span class="pre">r_where))</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> is the number of <cite>TT-cores</cite>: <code class="docutils literal notranslate"><span class="pre">what.ndims()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_what</span></code> is the largest <cite>TT-rank</cite> of <cite>what</cite>: <code class="docutils literal notranslate"><span class="pre">max(what.tt_rank())</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_where</span></code> is the largest <cite>TT-rank</cite> of <cite>where</cite></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> is the size of the axis dimension of <cite>what</cite> and <cite>where</cite> e.g.
for a tensor of size 4 x 4 x 4, <code class="docutils literal notranslate"><span class="pre">n</span></code> is 4;
for a 9 x 64 matrix of raw shape (3, 3, 3) x (4, 4, 4) <code class="docutils literal notranslate"><span class="pre">n</span></code> is 12</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>what</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – in the case of batch returns batch with projection of each individual tensor</p></li>
<li><p><strong>where</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – on which tangent space to project</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>TT-object</cite> with the <cite>TT-ranks</cite> equal <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">tangent_space_tens.tt_ranks()</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> or <cite>TT-Matrix</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.riemannian.tangent_to_deltas">
<code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">tangent_to_deltas</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tangent_element</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#ttax.base_class.TTMatrix" title="ttax.base_class.TTMatrix"><span class="pre">ttax.base_class.TTMatrix</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#ttax.riemannian.tangent_to_deltas" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an element of the tangent space to deltas representation.
Tangent space elements (outputs of <code class="docutils literal notranslate"><span class="pre">ttax.project</span></code>) look like:
<code class="docutils literal notranslate"><span class="pre">dP1</span> <span class="pre">V2</span> <span class="pre">...</span> <span class="pre">Vd</span> <span class="pre">+</span> <span class="pre">U1</span> <span class="pre">dP2</span> <span class="pre">V3</span> <span class="pre">...</span> <span class="pre">Vd</span> <span class="pre">+</span> <span class="pre">...</span> <span class="pre">+</span> <span class="pre">U1</span> <span class="pre">...</span> <span class="pre">Ud-1</span> <span class="pre">dPd</span></code>.
This function takes as input an element of the tangent space and converts
it to the list of deltas: <code class="docutils literal notranslate"><span class="pre">[dP1,</span> <span class="pre">...,</span> <span class="pre">dPd]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tangent_element</strong> (<cite>TT-Tensor</cite> or <cite>TT-Matrix</cite>) – a result of <code class="docutils literal notranslate"><span class="pre">ttax.project</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of delta-cores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.riemannian.tt_vmap">
<code class="sig-prename descclassname"><span class="pre">ttax.riemannian.</span></code><code class="sig-name descname"><span class="pre">tt_vmap</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batch_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.riemannian.tt_vmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator which makes a function support batch TT-inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_batch_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – <p>The amount of arguments that are batches of <cite>TT-objects</cite>.</p>
<ul class="simple">
<li><p>If None, than function will be mapped over all arguments.</p></li>
<li><p>If integer, specifies the count of first arguments to map over, e.g.
<cite>num_batch_args=n</cite> means that function will be mapped over
first <cite>n</cite> arguments.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decorator</p>
</dd>
</dl>
<dl class="simple">
<dt>Comments:</dt><dd><p>The function is vmapped <cite>num_batch_dims</cite> times, as it supports
multidimensional batches. The number of batch dimension to be
mapped over is shown by <cite>num_batch_dims</cite> property and should be
the same for all args of the function, by which it will be mapped over.
Otherwise such axis should be specified by <cite>num_batch_args</cite>.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-ttax.utils"></span><dl class="py class">
<dt id="ttax.utils.TT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">TT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.utils.TT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Tensor</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Tensor</cite> cores take form (r_l, n, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite></p></li>
<li><p>n makes <cite>TT-Tensor</cite> shape</p></li>
</ul>
<dl class="py method">
<dt id="ttax.utils.TT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.utils.TT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.utils.TT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Tensors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.utils.TT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case does not include the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TT.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.utils.TT.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.utils.TT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of <cite>TT-Tensor</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.utils.TT.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.utils.TT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.utils.TTBase">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">TTBase</span></code><a class="headerlink" href="#ttax.utils.TTBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents the base for both <cite>TT-Tensor</cite> and <cite>TT-Matrix</cite> (<cite>TT-object</cite>).
Includes some basic routines and properties.</p>
<dl class="py method">
<dt id="ttax.utils.TTBase.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.utils.TTBase.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTBase.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.utils.TTBase.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTBase.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.utils.TTBase.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTBase.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.utils.TTBase.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTBase.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.utils.TTBase.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTBase.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.utils.TTBase.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.utils.TTMatrix">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">TTMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt_cores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.utils.TTMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ttax.base_class.TTBase" title="ttax.base_class.TTBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ttax.base_class.TTBase</span></code></a></p>
<p>Represents a <cite>TT-Matrix</cite> object as a list of <cite>TT-cores</cite>.</p>
<p><cite>TT-Matrix</cite> cores take form (r_l, n_l, n_r, r_r), where</p>
<ul class="simple">
<li><p>r_l, r_r are <cite>TT-ranks</cite> just as for <cite>TT-Tensor</cite></p></li>
<li><p>n_l, n_r make left and right shapes of <cite>TT-Matrix</cite> as rows and cols</p></li>
</ul>
<dl class="py method">
<dt id="ttax.utils.TTMatrix.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.utils.TTMatrix.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTMatrix.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.utils.TTMatrix.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of <cite>TT-Matrices.</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTMatrix.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.utils.TTMatrix.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lists representing left and right shapes of <cite>TT-Matrix</cite>.
In batch case does not include the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
returns (2, 6), (3, 7).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shapes</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTMatrix.replace">
<code class="sig-name descname"><span class="pre">replace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.utils.TTMatrix.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>“Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.TTMatrix.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.utils.TTMatrix.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying dense tensor as matrix.
In batch case includes the shape of the batch.</p>
<p>For example if <cite>TT-Matrix</cite> cores are (1, 2, 3, 5) (5, 6, 7, 1)
it’s shape is (12, 21).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Matrix</cite> shape in dense form with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="ttax.utils.TTMatrix.tt_cores">
<code class="sig-name descname"><span class="pre">tt_cores</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.array</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ttax.utils.TTMatrix.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="ttax.utils.WrappedTT">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">WrappedTT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#ttax.base_class.TT" title="ttax.base_class.TT"><span class="pre">ttax.base_class.TT</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_einsum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ttax.utils.WrappedTT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class which wraps <cite>TT-object</cite>, which is needed for fusion to work.</p>
<p>Base <cite>TT-object</cite> class can only have jnp.array objects so that you can pass it into
jitted function. But, for fusing two functions together we need to track which
operation created a <cite>TT-object</cite>, so while fusing ops we wrap <cite>TT-objects</cite> with
this class, to track that.</p>
<dl class="py method">
<dt id="ttax.utils.WrappedTT.axis_dim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">axis_dim</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.axis_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the position of mode axis in underlying <cite>TT-core</cite>.
It could differ according to the batch shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>index</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.batch_loc">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_loc</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.batch_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the batch indexing for underlying <cite>TT-object</cite>.
Wraps <cite>TT-object</cite> by special <cite>BatchIndexing</cite> class
with overloaded <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method.</p>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">tt.batch_loc[1,</span> <span class="pre">:,</span> <span class="pre">:]</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.batch_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">batch_shape</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.batch_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list representing the shape of the batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.dtype">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">dtype</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the <cite>dtype</cite> of elements in underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>dtype</cite> of elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.is_tt_matrix">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the underlying <cite>TT-object</cite> is a <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite>, <cite>False</cite> if <cite>TT-Tensor</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.ndim">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ndim</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dimensions number</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.num_batch_dims">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">num_batch_dims</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.num_batch_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batch dimensions for batch of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of batch dimensions</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.raw_tensor_shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">raw_tensor_shape</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.raw_tensor_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
Depends on <code class="docutils literal notranslate"><span class="pre">raw_tensor_shape</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.shape">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">shape</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the tuple representing the shape of underlying <cite>TT-object</cite>.
In batch case includes the shape of the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-Tensor</cite> shape with batch shape</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.tt_cores">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_cores</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.tt_cores" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of <cite>TT-cores</cite> of underlying <cite>TT-object</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-cores</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ttax.utils.WrappedTT.tt_ranks">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">tt_ranks</span></code><a class="headerlink" href="#ttax.utils.WrappedTT.tt_ranks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <cite>TT-ranks</cite> of the underlying <cite>TT-object</cite> in amount of <code class="docutils literal notranslate"><span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1</span></code>.
The first <cite>TT-rank</cite> and the last one equals to <cite>1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>TT-ranks</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="ttax.utils.is_tt_matrix">
<code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">is_tt_matrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.utils.is_tt_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Matrix</cite> or <cite>WrappedTT</cite> with underlying <cite>TT-Matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Matrix</cite> or <cite>WrappedTT(TT-Matrix)</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.utils.is_tt_object">
<code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">is_tt_object</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.utils.is_tt_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Tensor</cite>, <cite>TT-Matrix</cite> or <cite>WrappedTT</cite> with one of them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-object</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="ttax.utils.is_tt_tensor">
<code class="sig-prename descclassname"><span class="pre">ttax.utils.</span></code><code class="sig-name descname"><span class="pre">is_tt_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="headerlink" href="#ttax.utils.is_tt_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the object is a <cite>TT-Tensor</cite> or <cite>WrappedTT</cite> with underlying <cite>TT-Tensor</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if <cite>TT-Tensor</cite> or <cite>WrappedTT(TT-Tensor)</cite>, <cite>False</cite> otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Alexander Novikov and Dmitry Belousov.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>